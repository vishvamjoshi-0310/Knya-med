<link
  rel="stylesheet"
  href="{{ 'interactive-card-grid-stylesheet.css' | asset_url }}"
  media="print"
  onload="this.media='all'"
>

<div class="interactive-card-grid">
  <div class="interactive-card-grid-inner">
    <div class="interactive-card-grid-heading-wrapper">
      <h2 class="interactive-card-grid-heading">{{ section.settings.heading }}</h2>
      <p class="interactive-card-grid-subheading">{{ section.settings.subheading }}</p>
    </div>
    <div class="interactive-card-grid-wrapper">
      {% for block in section.blocks %}
        <div class="interactive-card-grid-card">
          <div class="interactive-card-grid-card-image">
            {{
              block.settings.image
              | image_url: width: 500, format: 'webp'
              | image_tag:
                loading: 'lazy',
                fetchpriority: 'low',
                width: '500',
                height: 'auto',
                class: 'interactive-card-grid-card-image',
                widths: '375, 550, 750',
                alt: block.settings.title
            }}
          </div>
          <div class="interactive-card-details-overlay"></div>
          <div class="interactive-card-grid-card-content">
            <h3 class="interactive-card-grid-card-title">{{ block.settings.title }}</h3>
            <p class="interactive-card-grid-card-description">{{ block.settings.description }}</p>
            <p class="interactive-card-grid-card-hidden-text">{{ block.settings.hidden_text }}</p>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    // Only add click behavior on touch devices (mobile/tablet)
    if ('ontouchstart' in window || navigator.maxTouchPoints > 0) {
      const cards = document.querySelectorAll('.interactive-card-grid-card');

      cards.forEach((card) => {
        card.addEventListener('click', function (e) {
          e.preventDefault();

          // Remove clicked class from all other cards
          cards.forEach((otherCard) => {
            if (otherCard !== card) {
              otherCard.classList.remove('clicked');
            }
          });

          // Toggle clicked class on current card
          card.classList.toggle('clicked');
        });
      });

      // Close card when clicking outside
      document.addEventListener('click', function (e) {
        if (!e.target.closest('.interactive-card-grid-card')) {
          cards.forEach((card) => {
            card.classList.remove('clicked');
          });
        }
      });
    }
  });
</script>

{% schema %}
{
  "name": "interactive-card-grid",
  "class": "interactive-card-grid-parent",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading"
    }
  ],
  "blocks": [
    {
      "type": "card",
      "name": "Card",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title"
        },
        {
          "type": "text",
          "id": "description",
          "label": "Description"
        },
        {
          "type": "text",
          "id": "hidden_text",
          "label": "Hidden Text"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Interactive Card Grid"
    }
  ]
}
{% endschema %}
